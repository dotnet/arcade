parameters:
  # Which target pool should be used
  pool:
    name: 'NetCoreInternal-Pool'
    queue: 'BuildPool.Windows.10.Amd64.VS2017'

jobs:
- job: setupMaestroVars
  displayName: Setup Maestro Vars
  pool:
      name: ${{ parameters.pool.name }}
      queue: ${{ parameters.pool.queue }}
  steps:
    - task: DownloadBuildArtifacts@0
      displayName: Download Release Configs
      inputs:
        buildType: current
        artifactName: 'ReleaseConfigs'

    - task: powershell@1
      name: setReleaseVars
      displayName: Set Release Configs Vars
      inputs:
        scriptType: inlineScript
        inlineScript: |
          $BarId = Get-Content "$(Build.StagingDirectory)/ReleaseConfigs/BARBuildId.txt" 
          Write-Host "##vso[task.setvariable variable=BARBuildId;isoutput=true]$BarId"
            
          Get-Content "$(Build.StagingDirectory)/ReleaseConfigs/Channels.txt" | ForEach-Object { $Channels += "$_ ," }
          Write-Host "##vso[task.setvariable variable=InitialChannels;isoutput=true]$Channels"
