<!-- Licensed to the .NET Foundation under one or more agreements. The .NET Foundation licenses this file to you under the MIT license. -->
<Project>

  <PropertyGroup>
    <!-- TFM filtering is enabled by default and can be disabled, at repo level, by setting NoTargetFrameworkFiltering propert
         to true, in repo's root Directory.Build.props file. -->
    <DotNetTargetFrameworkFilter Condition="'$(DotNetTargetFrameworkFilter)' == '' and '$(DotNetBuildSourceOnly)' == 'true'">netstandard2.0%3bnetstandard2.1%3bnetcoreapp2.1%3bnetcoreapp3.1%3bnet5.0%3bnet6.0%3bnet7.0%3bnet8.0%3bnet9.0%3bnet10.0%3bnet11.0%3b$(NetCurrent)</DotNetTargetFrameworkFilter>

    <_EnableTargetFrameworkFiltering>false</_EnableTargetFrameworkFiltering>
    <_EnableTargetFrameworkFiltering Condition="'$(NoTargetFrameworkFiltering)' != 'true' and '$(DotNetTargetFrameworkFilter)' != ''">true</_EnableTargetFrameworkFiltering>
  </PropertyGroup>

  <PropertyGroup Condition="$(_EnableTargetFrameworkFiltering)">
    <_OriginalTargetFrameworks Condition="'$(TargetFrameworks)' != ''">$(TargetFrameworks)</_OriginalTargetFrameworks>
    <_OriginalTargetFrameworks Condition="'$(TargetFramework)' != ''">$(TargetFramework)</_OriginalTargetFrameworks>
    <_FilteredTargetFrameworks>$([MSBuild]::Unescape($([MSBuild]::FilterTargetFrameworks('$(_OriginalTargetFrameworks)', '$(DotNetTargetFrameworkFilter)'))))</_FilteredTargetFrameworks>
    <!-- Maintain usage of the original property -->
    <TargetFrameworks Condition="'$(TargetFrameworks)' != ''">$(_FilteredTargetFrameworks)</TargetFrameworks>
    <TargetFramework Condition="'$(TargetFramework)' != ''">$(_FilteredTargetFrameworks)</TargetFramework>
    <!-- If nothing left to build, exclude it! -->
    <ExcludeFromBuild Condition="'$(_FilteredTargetFrameworks)' == ''">true</ExcludeFromBuild>
  </PropertyGroup>

</Project>
