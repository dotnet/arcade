<!-- Licensed to the .NET Foundation under one or more agreements. The .NET Foundation licenses this file to you under the MIT license. -->
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <!-- All the directories are broken into separate fragments. References to specific directories should be sufficient to
       pull them into an installer. -->
  <Fragment>
    <StandardDirectory Id="ProgramFiles6432Folder">
      <Directory Id="DOTNETHOME" Name="dotnet" />
    </StandardDirectory>

    <!-- This custom action is necessary to override the DOTNETHOME value when installing x64 on arm64. -->
    <?if $(InstallerPlatform)~=x64?>
    <CustomActionRef Id="Set_DOTNETHOME_NON_NATIVE_ARCHITECTURE" />
    <?endif?>
  </Fragment>

  <!-- InstallDir should only be defined for workload packs -->
  <?ifdef InstallDir?>
  <Fragment>
    <DirectoryRef Id="DOTNETHOME">
      <Directory Id="InstallDir" Name="$(var.InstallDir)">
        <?if $(var.PackKind) != "library" and $(var.PackKind) != "template"?>
        <Directory Id="PackageDir" Name="$(var.PackageId)">
          <Directory Id="VersionDir" Name="$(var.PackageVersion)" />
        </Directory>
        <?endif?>
      </Directory>
    </DirectoryRef>
  </Fragment>
  <?endif?>

  <?ifdef SdkFeatureBandVersion?>
  <Fragment>
    <DirectoryRef Id="DOTNETHOME">
      <Directory Id="SdkManifestsDir" Name="sdk-manifests">
        <Directory Id="SdkFeatureBandVersionDir" Name="$(var.SdkFeatureBandVersion)" />
      </Directory>
    </DirectoryRef>
  </Fragment>
  <?endif?>

  <?ifdef WorkloadSetVersion?>
  <Fragment>
    <DirectoryRef Id="SdkFeatureBandVersionDir">
      <Directory Id="WorkloadSetsDir" Name="workloadsets">
        <Directory Id="WorkloadSetVersionDir" Name="$(var.WorkloadSetVersion)" />
      </Directory>
    </DirectoryRef>
  </Fragment>
  <?endif?>

  <?ifdef ManifestId?>
  <Fragment>
    <DirectoryRef Id="SdkFeatureBandVersionDir">
      <Directory Id="ManifestIdDir" Name="$(var.ManifestId)">
        <?ifdef ManifestVersion ?>
        <Directory Id="ManifestVersionDir" Name="$(var.ManifestVersion)" />
        <?endif?>
      </Directory>
    </DirectoryRef>
  </Fragment>
  <?endif?>
</Wix>
