<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>$(NetToolCurrent);$(NetFrameworkToolCurrent)</TargetFrameworks>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\Common\Microsoft.Arcade.Test.Common\Microsoft.Arcade.Test.Common.csproj" />
    <ProjectReference Include="..\Microsoft.DotNet.Build.Tasks.Workloads\src\Microsoft.DotNet.Build.Tasks.Workloads.csproj" />
    <ProjectReference Include="..\Microsoft.DotNet.XUnitExtensions\src\Microsoft.DotNet.XUnitExtensions.csproj" />

    <PackageReference Include="Microsoft.Build.Utilities.Core" />
    <PackageReference Include="Microsoft.Deployment.DotNet.Releases" />
    <PackageReference Include="Microsoft.NET.Sdk.WorkloadManifestReader" />
    <PackageReference Include="Microsoft.Signed.Wix" />

    <PackageReference Include="Microsoft.WixToolset.Dtf.Compression" />
    <PackageReference Include="Microsoft.WixToolset.Dtf.Compression.Cab" />
    <PackageReference Include="Microsoft.WixToolset.Dtf.Resources" />
    <PackageReference Include="Microsoft.WixToolset.Dtf.WindowsInstaller" />
    <PackageReference Include="Microsoft.WixToolset.Dtf.WindowsInstaller.Package" />
    <PackageReference Include="FluentAssertions" />
  </ItemGroup>

  <!-- The tests reference the MSBuild task assembly directly and therefore we need to add references that would normally be provided by MSBuild. -->
  <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETCoreApp'">
    <PackageReference Include="NuGet.Packaging" />
  </ItemGroup>

  <!-- Sample packages -->
  <ItemGroup>
    <!-- Microsoft.wix is the WiX CLI -->
    <PackageDownload Include="Microsoft.wix" Version="[$(MicrosoftWixToolsetSdkVersion)]" />
    <PackageDownload Include="Microsoft.WixToolset.Heat" Version="[$(MicrosoftWixToolsetSdkVersion)]" />
    <PackageDownload Include="Microsoft.Signed.Wix" Version="[$(MicrosoftSignedWixVersion)]" />
    <PackageDownload Include="Microsoft.NET.Workload.Mono.ToolChain.Manifest-6.0.200" Version="[$(MicrosoftNETWorkloadMonoToolChainManifest_60200Version)];[$(MicrosoftNETWorkloadMonoToolChainManifest_60200Version_604)]" />
    <PackageDownload Include="Microsoft.NET.Workload.Mono.ToolChain.Manifest-6.0.300" Version="[$(MicrosoftNETWorkloadMonoToolChainManifest_60300Version_6021)];[$(MicrosoftNETWorkloadMonoToolChainManifest_60300Version_6022)]" />
    <PackageDownload Include="Microsoft.iOS.Templates" Version="[$(MicrosoftiOSTemplatesVersion)];[$(MicrosoftiOSTemplatesVersion160527)]" />
    <PackageDownload Include="Microsoft.NET.Workload.Emscripten.net6.Manifest-8.0.100-preview.6" Version="[$(MicrosoftNETWorkloadEmscriptenManifest_80100Preview6Version)]" />
    <!-- We can only test the task properly by building an actual workload end-to-end. EMSDK is the tiniest one available -->
    <PackageDownload Include="Microsoft.NET.Workload.Emscripten.Manifest-6.0.200" Version="[$(MicrosoftNETWorkloadEmscriptenManifest_60200Version)]" />
    <PackageDownload Include="Microsoft.NET.Runtime.Emscripten.2.0.23.Node.win-x64" Version="[$(MicrosoftNETRuntimeEmscripten2023Nodewin_x64)]" />
    <PackageDownload Include="Microsoft.NET.Runtime.Emscripten.2.0.23.Python.win-x64" Version="[$(MicrosoftNETRuntimeEmscripten2023Pythonwin_x64)]" />
    <PackageDownload Include="Microsoft.NET.Runtime.Emscripten.2.0.23.Sdk.win-x64" Version="[$(MicrosoftNETRuntimeEmscripten2023Sdkwin_x64)]" />
    <PackageDownload Include="Microsoft.NET.Workloads.9.0.100" Version="[$(MicrosoftNETWorkloadBaselineVersion)]" />
    
    <PackageDownload Include="Microsoft.NET.Workload.Mono.ToolChain.Current.Manifest-10.0.100" Version="[10.0.100]" />
    <PackageDownload Include="Microsoft.NET.Runtime.WebAssembly.Sdk" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NET.Sdk.WebAssembly.Pack" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.browser-wasm" Version="[10.0.0]" />                              
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.browser-wasm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.browser-wasm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.multithread.browser-wasm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NET.Runtime.WebAssembly.Wasi.Sdk" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.wasi-wasm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NET.Runtime.WebAssembly.Templates.net10" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.wasi-wasm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.wasi-wasm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NET.Runtime.LibraryBuilder.Sdk" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.android-arm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.android-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.android-x64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.android-x86" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-x86" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-x86" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-x64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-x64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-arm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-arm" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.ios-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.iossimulator-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.iossimulator-x64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.maccatalyst-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.maccatalyst-x64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.tvos-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.tvossimulator-arm64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NETCore.App.Runtime.Mono.tvossimulator-x64" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NET.Runtime.MonoAOTCompiler.Task" Version="[10.0.0]" />
    <PackageDownload Include="Microsoft.NET.Runtime.MonoTargets.Sdk" Version="[10.0.0]" />

  </ItemGroup>

  <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">
    <PackageReference Include="System.Text.Json" />
  </ItemGroup>
  
  <ItemGroup>
    <Content Include="testassets\**\*" CopyToOutputDirectory="PreserveNewest" />
    <!--<Content Include="$(NuGetPackageRoot)microsoft.signed.wix\$(MicrosoftSignedWixVersion)\tools\**\*" Link="testassets\wix\%(RecursiveDir)%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />-->
    <Content Include="$(NuGetPackageRoot)microsoft.wix\$(MicrosoftWixToolsetSdkVersion)\tools\**\*" Link="testassets\wix\%(RecursiveDir)%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.wixtoolset.heat\$(MicrosoftWixToolsetSdkVersion)\tools\**\*" Link="testassets\heat\%(RecursiveDir)%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.mono.toolchain.manifest-6.0.200\$(MicrosoftNETWorkloadMonoToolChainManifest_60200Version)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.mono.toolchain.manifest-6.0.200\$(MicrosoftNETWorkloadMonoToolChainManifest_60200Version_604)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.mono.toolchain.manifest-6.0.300\$(MicrosoftNETWorkloadMonoToolChainManifest_60300Version_6022)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.mono.toolchain.manifest-6.0.300\$(MicrosoftNETWorkloadMonoToolChainManifest_60300Version_6021)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.ios.templates\$(MicrosoftiOSTemplatesVersion)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.ios.templates\$(MicrosoftiOSTemplatesVersion160527)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.emscripten.manifest-6.0.200\$(MicrosoftNETWorkloadEmscriptenManifest_60200Version)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.emscripten.net6.manifest-8.0.100-preview.6\$(MicrosoftNETWorkloadEmscriptenManifest_80100Preview6Version)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.runtime.emscripten.2.0.23.node.win-x64\$(MicrosoftNETRuntimeEmscripten2023Nodewin_x64)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.runtime.emscripten.2.0.23.python.win-x64\$(MicrosoftNETRuntimeEmscripten2023Pythonwin_x64)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.runtime.emscripten.2.0.23.sdk.win-x64\$(MicrosoftNETRuntimeEmscripten2023Sdkwin_x64)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)microsoft.net.workloads.9.0.100\$(MicrosoftNETWorkloadBaselineVersion)\*.nupkg" Link="testassets\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    
    <Content Include="$(NuGetPackageRoot)microsoft.net.workload.mono.toolchain.current.manifest-10.0.100\10.0.100\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Runtime.WebAssembly.Sdk\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Sdk.WebAssembly.Pack\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.browser-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.browser-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.browser-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Runtime.WebAssembly.Templates.net10\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.multithread.browser-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Runtime.WebAssembly.Wasi.Sdk\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.wasi-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.wasi-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.wasi-wasm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Runtime.LibraryBuilder.Sdk\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.android-arm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.android-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.android-x64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.android-x86\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-x86\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-x86\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-x64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-x64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-arm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-arm\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-x64.Cross.android-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.AOT.win-arm64.Cross.android-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.ios-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.iossimulator-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.iossimulator-x64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.maccatalyst-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.maccatalyst-x64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.tvos-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.tvossimulator-arm64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NETCore.App.Runtime.Mono.tvossimulator-x64\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Runtime.MonoAOTCompiler.Task\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
    <Content Include="$(NuGetPackageRoot)Microsoft.NET.Runtime.MonoTargets.Sdk\10.0.0\*.nupkg" Link="testassets\wasm\%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" Visible="false" />
  </ItemGroup>

  <ItemGroup>
    <None Remove="testassets\AliasedPacks.json" />
    <None Remove="testassets\emsdkWorkloadManifest.json" />
    <None Remove="testassets\emsdkWorkloadManifest2.json" />
    <None Remove="testassets\mauiWorkloadManifest.json" />
  </ItemGroup>  
</Project>
